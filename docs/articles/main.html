<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Overview of `attackR` • attackR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Overview of `attackR`">
<meta property="og:description" content="attackR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">attackR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/main.html">Overview of `attackR`</a>
    </li>
    <li>
      <a href="../articles/whales.html">`attackR` and whale attacks</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nicholascarey/attackR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="main_files/header-attrs-2.3/header-attrs.js"></script><script src="main_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Overview of <code>attackR</code>
</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/nicholascarey/attackR/blob/master/vignettes/main.Rmd"><code>vignettes/main.Rmd</code></a></small>
      <div class="hidden name"><code>main.Rmd</code></div>

    </div>

    
    
<p>The <code>attackR</code> package for <code>R</code> models how much of a prey’s visual field is occupied by a predator as it attacks, given information on the predator shape, size and speed.</p>
<p>Its intended use is in biological studies of prey escape behaviours, where they are known or hypothesised to respond to particular thresholds of angular size of the predator (e.g. Temizer et al. 2015), or rate of change of this angular size (e.g. Paglianti &amp; Domenici 2006) (note, other models incorporate other variables to determine escape response likelihoods, such as presence of other prey; see Hatsopoulos 1995, Preuss 2006, Hein et al. 2019).</p>
<p>The code was developed for a study published in PNAS <a href="https://doi.org/10.1073/pnas.1911099116">(Cade et al. 2020)</a> on humpback whale foraging on anchovies. In the case of whales it has special functionality for determining how the timing of the whale’s mouth opening during a lunge feeding event affects how much of the prey’s visual field is occupied. However, it can be used with virtually any predator-prey combination.</p>
<div class="figure" style="text-align: center">
<img src="../../../Github%20repositories/attackR/vignettes/pnascover.jpg" alt="Cade et al. 2020" width="40%"><p class="caption">
Cade et al. 2020
</p>
</div>
<p>While the following explanation is fairly straightforward and may seem overly precise, the extreme and unique characteristics of the biomechanics of whale lunge feeding necessitated this level of detail. See [HERE] for an explanation of this approach applied to whales.</p>
<div id="background" class="section level1">
<h1 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h1>
<p>When a predator approaches a prey, it occupies space in the prey’s visual field. That is, its profile subtends an angle (<strong>⍺</strong>) on the prey’s retina, usually determined by its maximum width (Dill 1974):</p>
<p><br><img src="../../../Github%20repositories/attackR/vignettes/schem1.png" width="100%" style="display: block; margin: auto;"><br></p>
<p>If the predator comes closer, the angle increases. The rate of change in <strong>⍺</strong>, that is <strong>d⍺/dt</strong>, is simply the change in <strong>⍺</strong> divided by the time this took.</p>
<p><br><img src="../../../Github%20repositories/attackR/vignettes/schem2.png" width="100%" style="display: block; margin: auto;"><br></p>
<p>Note as the predator gets closer, depending on its shape the widest <em>apparent</em> part of it from the prey’s perspective may shift forward along the body. Given a predator shape profile, <code>attackR</code> takes account of this shift when calculating <strong>⍺</strong> and <strong>d⍺/dt</strong>.</p>
<p>As the predator gets closer, it takes up a relatively greater proportion of the visual field, so at constant speeds both <strong>⍺</strong> and <strong>d⍺/dt</strong> show an exponential relationship with distance/time:</p>
<p><br><img src="../../../Github%20repositories/attackR/vignettes/Rplot.png" width="100%" style="display: block; margin: auto;"><br></p>
<p>The <strong>d⍺/dt</strong> allows the prey to judge how fast the predator is approaching, decide if it is a threat and thus whether to initiate an escape response. Studies have shown many prey species react to consistent values of <strong>d⍺/dt</strong> which, when applied to their common predators, represent evolutionarily determined predator speed:distance combinations which minimise redundant or unnecessary escape attempts but maximise the chances of escape when the predator is a real threat.</p>
<p>From the prey perspective, the attacker can be approximated by a circular shape projected on a screen that reproduces the same <strong>⍺</strong> and <strong>d⍺/dt</strong> at a particular viewing distance. These ‘looming animations’ are commonly used to study escape responses and determine thresholds of <strong>d⍺/dt</strong> at which escape responses are initiated (e.g. the Apparent Looming Threshold or <em>ALT</em>, Dill 1974). See the <a href="https://nicholascarey.github.io/loomeR/"><code>loomeR</code></a> package for creating looming animations, including from <code>attackR</code> models.</p>
<p><br><img src="../../../Github%20repositories/attackR/vignettes/response.png" width="50%" style="display: block; margin: auto;"><br></p>
<p><strong>⍺</strong> and <strong>d⍺/dt</strong> are determined by several aspects of the predator; its size, speed and shape. The <code>attackR</code> package uses these to calculate <strong>⍺</strong> and <strong>d⍺/dt</strong> for every stage of a hypothetical attack, and given threshold values of <strong>d⍺/dt</strong> for the prey, the distance of the predator at that moment and the time remaining until it is captured, assuming it does not move.</p>
</div>
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h1>
<p>Here is a typical input for the <code>attack_model</code> function which determines <strong>⍺</strong>.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="../reference/attack_model.html">attack_model</a></span>(<span class="kw">speed</span> <span class="kw">=</span> <span class="fl">350</span>,                <span class="co"># speed in cm/s</span>
             <span class="kw">model_length</span> <span class="kw">=</span> <span class="fl">500</span>,         <span class="co"># determines how far away predator starts attack from</span>
             <span class="kw">frequency</span> <span class="kw">=</span> <span class="fl">60</span>,             <span class="co"># resolution/frame rate in Hz</span>
             <span class="kw">body_length</span> <span class="kw">=</span> <span class="fl">146</span>,          <span class="co"># cm - from nose to tail</span>
             <span class="kw">body_width_v</span> <span class="kw">=</span> <span class="fl">45</span>,          <span class="co"># cm - width at maximum width in vertical plane</span>
             <span class="kw">profile_v</span> <span class="kw">=</span> <span class="no">sl_profile_v</span>)   <span class="co"># shape profile in vertical plane</span></pre></body></html></div>
<p>These are the minumum required inputs, but there are others (<a href="https://nicholascarey.github.io/attackR/reference/attack_model.html">see here</a> for full list).</p>
<p>As a general overview of what the function does:</p>
<ul>
<li>For every instance of the model (i.e. <code>1:model_length</code>), it calculates how far away the predator is at the given <code>speed</code>
</li>
<li>Using the shape profile, it calculates the <strong>⍺</strong> of every part of the predator’s body at the resolution of the units used in the morphometric inputs (in this case every <code>cm</code> along the body)</li>
<li>It determines which of these <strong>⍺</strong> is largest. Usually this is at the maximum width, but at close distances more anterior parts of the body may project a larger <strong>⍺</strong>
</li>
<li>If both vertical and horizontal morphometric inputs are entered (see example below) it filters between the vertical and horizontal maximum <strong>⍺</strong> in various ways</li>
<li>It determines this final <strong>⍺</strong>, and this is used to calculate <strong>d⍺/dt</strong>
</li>
</ul>
</div>
<div id="example-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#example-analysis" class="anchor"></a>Example analysis</h1>
<p>Here we will show a simple example of how <code>attackR</code> determines the <strong>⍺</strong> and <strong>d⍺/dt</strong> for an attack by a California sea-lion (<em>Zalophus californianus</em>).</p>
<div id="shape" class="section level2">
<h2 class="hasAnchor">
<a href="#shape" class="anchor"></a>1. Shape</h2>
<p>To determine the <strong>⍺</strong> of a predator, especially how it may change as it gets closer to the prey, <code>attack_model</code> requires a shape profile. The shape profile is simply a vector of proportional widths evenly-spaced along the body from nose to tail (or their equivalents). The predator’s length and maximum width values are entered separately. There are various ways to construct these profiles, from simple to complex: e.g. measured from photos or other morphometric measurements, or determined digitally. Here, as an example we will use an outline of a sea-lion (Fig. 5, Feldkamp 1987) extracted from underwater photos. This study also tells us a sea-lion’s maximum width is situated 40% along the body from the snout (<strong>d</strong> in the Figure). Table 1 also gives us some measurements of a sea-lion (146 cm length, 45 cm maximum diameter).</p>
<p>We are going to apply these morphometric measurements and our derived profile to calculate the <strong>⍺</strong> of this sea-lion.</p>
<p><br><img src="../../../Github%20repositories/attackR/vignettes/feldkamp.png" height="140" style="display: block; margin: auto;"><br></p>
<div id="simple-shape-profile" class="section level4">
<h4 class="hasAnchor">
<a href="#simple-shape-profile" class="anchor"></a>Simple shape profile</h4>
<p>The simplest shape profile consists of only three points: proportional widths at the nose, tail and midpoint of the body (there can be any number of widths in a profile, but they must be <em>evenly spaced along the body</em>, which in this case means the midpoint). The location of the maximum width along the body is also required, if it doesn’t happen to occur at the midpoint. This is expressed as a location along the length as a proportion of the total length from the nose. It can be anterior or posterior of the midpoint. In this case it is <em>40%</em> along the body, so entered as <em>0.40</em>. The nose and tail will typically be zero, but don’t have to be.</p>
<p>Only three measurements are required here. We will use <a href="https://imagej.net/Welcome">ImageJ</a> (more specifically <a href="https://imagej.net/Fiji">Fiji</a>), but they could be done with a print out and a ruler since only proportional relationships are required.</p>
<ul>
<li>total length (green line) (to determine where the midpoint is)</li>
<li>maximum width (red line)</li>
<li>midpoint width (blue line)</li>
</ul>
<p>These are used to calculate the midpoint width expressed as a <em>proportion of the maximum width</em>. For example, here the midpoint and maximum widths were measured in ImageJ as 360 and 377 pixels respectively, so the <em>proportional</em> midpoint width is: 360/377 = 0.95.</p>
<p><br><img src="../../../Github%20repositories/attackR/vignettes/feldkamp_simple.png" height="140" style="display: block; margin: auto;"><br> The function interpolates between these measurements to approximate the shape of the predator at the resolution of the units used, which in this case would be every cm. For every stage of the attack, it will calculate <strong>⍺</strong> at every cm along the body and determine which is greatest at any particular viewing distance.</p>
<p>This interpolated profile is obviously a very simplistic representation of the animal. In this representation, because the body anterior of the maximum width is perfectly triangular, at all viewing distances the maximum width will project the maximum <strong>⍺</strong>. However in reality, more anterior parts of the body may project a larger <strong>⍺</strong>:</p>
<p><br><img src="../../../Github%20repositories/attackR/vignettes/alpha_simple.png" height="140" style="display: block; margin: auto;"><br></p>
<p>In this example with the sleek sea-lion, the difference this makes to <strong>⍺</strong> are probably minor, but in predators with different shapes this could cause considerable differences. (See the <a href="https://nicholascarey.github.io/attackR/articles/whales.html">whale vignette</a> for an example).</p>
</div>
<div id="more-accurate-shape-profile" class="section level4">
<h4 class="hasAnchor">
<a href="#more-accurate-shape-profile" class="anchor"></a>More accurate shape profile</h4>
<p>The higher the resolution of the profile, the better its representation of the predator shape, and better estimate of how <strong>⍺</strong> changes. Therefore, you may want to input a more representative shape profile.</p>
<p>The shape profiles used by <code>attackR</code> can be at any resolution as long as they are evenly spaced. Here is an example where we determine proportional widths at every 5% along the body. Again, this could be done very quickly with a printout and ruler. Here, the profile image was opened in a simple graphics application, and scaled to a grid so that its length occupied 20 units.</p>
<p><br><img src="../../../Github%20repositories/attackR/vignettes/feldkamp_grid.png" height="140" style="display: block; margin: auto;"><br></p>
<p>Here, all that is required is measurements of the blue lines, again using <a href="https://imagej.net/Welcome">ImageJ</a>.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co">## Measurements from ImageJ</span>
<span class="no">pixel_widths_v</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">121</span>, <span class="fl">166</span>, <span class="fl">182</span>, <span class="fl">204</span>, <span class="fl">246</span>,
                  <span class="fl">303</span>, <span class="fl">343</span>, <span class="fl">377</span>, <span class="fl">373</span>, <span class="fl">360</span>,
                  <span class="fl">359</span>, <span class="fl">344</span>, <span class="fl">309</span>, <span class="fl">256</span>, <span class="fl">192</span>,
                  <span class="fl">147</span>, <span class="fl">136</span>, <span class="fl">133</span>, <span class="fl">129</span>, <span class="fl">0</span>)

<span class="co">## Convert to proportional</span>
<span class="no">sl_profile_v</span> <span class="kw">&lt;-</span> <span class="no">pixel_widths_v</span>/<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">pixel_widths_v</span>)

<span class="co">## Print</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="no">sl_profile_v</span>, <span class="fl">2</span>))
<span class="co">#&gt;  [1] 0.00 0.32 0.44 0.48 0.54 0.65 0.80 0.91 1.00 0.99 0.95 0.95 0.91 0.82 0.68</span>
<span class="co">#&gt; [16] 0.51 0.39 0.36 0.35 0.34 0.00</span></pre></body></html></div>
<p>Note, that because this profile contains a measurement for the maximum width (i.e. it lies at 0.40 along the body in this case), to get the proportional profile we can simply divide the pixel widths by its maximum value, and we can see the final profile contains a value of 1.0. Therefore, it does not need to be entered separately via the <code>max_width_loc_v</code> input. If it happened to lie intermediate to one of the measurements at the chosen resolution, the pixel widths would have to be divided by the pixel width at the maximum width location, and its position would be entered via <code>max_width_loc_v</code> (see above example). Therefore, it’s always easier to use profiles at a resolution that captures the maximum width.</p>
<p><br><img src="../../../Github%20repositories/attackR/vignettes/feldkamp_complex.png" height="140" style="display: block; margin: auto;"><br></p>
<p>It’s immediately clear that this interpolated profile is much more representative of the true predator body shape, and so estimates of <strong>⍺</strong> will be more realistic at close distances.</p>
</div>
<div id="horizontal-and-vertical-shape-profiles" class="section level4">
<h4 class="hasAnchor">
<a href="#horizontal-and-vertical-shape-profiles" class="anchor"></a>Horizontal and vertical shape profiles</h4>
<p>What if the predator has a different shape in the horizontal and vertical profiles of its body? A sea-lion is fairly consistently shaped along its body in both planes, so the above example would probably be sufficient to represent the <strong>⍺</strong> of the body as a whole. However, the <code>attack_model</code> function allows both horizontal and vertical profiles to be entered, and selection of which <strong>⍺</strong> between them to use.</p>
<p>Note how in the above examples inputs are appended by <code>_v</code>. This relates to the vertical profile, and there are similar inputs for the horizontal profile appended with <code>_h</code>.</p>
<p>Here we construct a horizontal shape profile (image from Fig. 3a, English 1976). We ignore the flippers and approximate the shape of the body in the fin regions because they are thin relative to the body in the frontal view, and so don’t contribute significantly to the <strong>⍺</strong> of the predator as a whole (the overall aim is to approximate the size of the looming predator in the prey’s visual field, not capture every detail).</p>
<p><br><img src="../../../Github%20repositories/attackR/vignettes/english_grid.png" height="140" style="display: block; margin: auto;"><br></p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co">## Measurements from ImageJ</span>
<span class="no">pixel_widths_h</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">110</span>, <span class="fl">186</span>, <span class="fl">250</span>, <span class="fl">278</span>, <span class="fl">320</span>,
                  <span class="fl">346</span>, <span class="fl">392</span>, <span class="fl">416</span>, <span class="fl">426</span>, <span class="fl">420</span>,
                  <span class="fl">392</span>, <span class="fl">394</span>, <span class="fl">352</span>, <span class="fl">308</span>, <span class="fl">284</span>,
                  <span class="fl">252</span>, <span class="fl">222</span>, <span class="fl">260</span>, <span class="fl">310</span>, <span class="fl">0</span>)

<span class="co">## Convert to proportional</span>
<span class="no">sl_profile_h</span> <span class="kw">&lt;-</span> <span class="no">pixel_widths_h</span>/<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">pixel_widths_h</span>)

<span class="co">## Print</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="no">sl_profile_h</span>, <span class="fl">2</span>))
<span class="co">#&gt;  [1] 0.00 0.26 0.44 0.59 0.65 0.75 0.81 0.92 0.98 1.00 0.99 0.92 0.92 0.83 0.72</span>
<span class="co">#&gt; [16] 0.67 0.59 0.52 0.61 0.73 0.00</span></pre></body></html></div>
<p>Now we can input both profiles and use <code>width_filter</code> to select which <strong>⍺</strong> between horizontal and vertical planes to use for every instance of the model. We can also have one plane a different width than the other at the maximum width for predators that are more ellipsoid in shape.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="../reference/attack_model.html">attack_model</a></span>(<span class="kw">speed</span> <span class="kw">=</span> <span class="fl">350</span>,               <span class="co"># speed in cm/s</span>
             <span class="kw">model_length</span> <span class="kw">=</span> <span class="fl">500</span>,        <span class="co"># determines how far away predator starts attack from</span>
             <span class="kw">frequency</span> <span class="kw">=</span> <span class="fl">60</span>,            <span class="co"># resolution/frame rate in Hz</span>
             <span class="kw">body_length</span> <span class="kw">=</span> <span class="fl">146</span>,         <span class="co"># cm - from nose to tail</span>
             <span class="kw">body_width_v</span> <span class="kw">=</span> <span class="fl">45</span>,         <span class="co"># cm - width at maximum width in vertical plane</span>
             <span class="kw">profile_v</span> <span class="kw">=</span> <span class="no">sl_profile_v</span>,  <span class="co"># shape profile in vertical plane</span>
             <span class="kw">body_width_h</span> <span class="kw">=</span> <span class="fl">50</span>,         <span class="co"># cm - width at maximum width in horizontal plane</span>
             <span class="kw">profile_h</span> <span class="kw">=</span> <span class="no">sl_profile_h</span>,  <span class="co"># shape profile in horizontal plane</span>
             <span class="kw">width_filter</span> <span class="kw">=</span> <span class="st">"mid"</span>)      <span class="co"># how to select ⍺ between v and h </span></pre></body></html></div>
<p>The <code>width_filter</code> has the following options to select between vertical and horizontal maximum <strong>⍺</strong> if they differ:</p>
<ul>
<li>
<code>"mid"</code> - midpoint or mean value (the default)</li>
<li>
<code>"max"</code> - maximum value</li>
<li>
<code>"min"</code> - minimum value</li>
<li>
<code>"v"</code> - use vertical value <em>only</em> regardless of horizontal value</li>
<li>
<code>"h"</code> - use horizontal value <em>only</em> regardless of vertical value</li>
<li>
<code>"max_width_v"</code> - use the <strong>⍺</strong> of the vertical max width, ignore all other parts of body</li>
<li>
<code>"max_width_h"</code> - use the <strong>⍺</strong> of the horizontal max width, ignore all other parts of body</li>
</ul>
<p>It depends on the predator shape which of these you may want to use to best represent its ‘true’ <strong>⍺</strong> when using the model in experiments.</p>
</div>
</div>
<div id="other-inputs" class="section level2">
<h2 class="hasAnchor">
<a href="#other-inputs" class="anchor"></a>2. Other inputs</h2>
<p>The other inputs to the <code>attack_model</code> function are fairly self explanatory:</p>
<div id="speed" class="section level4">
<h4 class="hasAnchor">
<a href="#speed" class="anchor"></a><code>speed</code>
</h4>
<p>The speed need not be a single value, but can be a vector of variable speeds at the input <code>frequency</code>. In this case, <code>model_length</code> is not required, and it is assumed the predator meets the prey at the last value in the <code>speed</code> vector. However, if you want the predator to meet the prey earlier, a <code>model_length</code> value less than the length of the <code>speed</code> vector can be entered. Units must be same length unit as morphometric inputs <em>per second</em>.</p>
</div>
<div id="body_length-body_width_vbody_width_h" class="section level4">
<h4 class="hasAnchor">
<a href="#body_length-body_width_vbody_width_h" class="anchor"></a><code>body_length</code>, <code>body_width_v</code>,<code>body_width_h</code>,</h4>
<p>It is important that all morphometric inputs are in the same length units, and that <code>speed</code> also uses the <em>same length unit per second</em>.</p>
</div>
<div id="frequency" class="section level4">
<h4 class="hasAnchor">
<a href="#frequency" class="anchor"></a><code>frequency</code>
</h4>
<p>Resolution of the model in Hz. How many <strong>⍺</strong>, <strong>d⍺/dt</strong> etc. calculated per second. If <code>speed</code> is a vector should be at same resolution. Equivalent to frame rate or FPS, and any looming animation created by the <code>loomeR</code> package will use this as the frame rate.</p>
</div>
<div id="max_width_loc_v-max_width_loc_h" class="section level4">
<h4 class="hasAnchor">
<a href="#max_width_loc_v-max_width_loc_h" class="anchor"></a><code>max_width_loc_v</code>, <code>max_width_loc_h</code>
</h4>
<p>Location of these along the body from the nose as a proportion of the total length. Only required if they are not included as part of the shape profiles.</p>
</div>
<div id="plot-plot_from-plot_to" class="section level4">
<h4 class="hasAnchor">
<a href="#plot-plot_from-plot_to" class="anchor"></a><code>plot</code>, <code>plot_from</code>, <code>plot_to</code>
</h4>
<p>Plot the resulting <strong>⍺</strong> and <strong>d⍺/dt</strong>, and specify the X-axis range (in time units).</p>
</div>
<div id="alpha_range-dadt_range" class="section level4">
<h4 class="hasAnchor">
<a href="#alpha_range-dadt_range" class="anchor"></a><code>alpha_range</code>, <code>dadt_range</code>
</h4>
<p>Plot a range of <strong>⍺</strong> and <strong>d⍺/dt</strong>. Each input is a vector of two values. If <code>simple_output = FALSE</code> these ranges are also subset into their own elements of the output <code>list</code> object.</p>
</div>
<div id="simple_output" class="section level4">
<h4 class="hasAnchor">
<a href="#simple_output" class="anchor"></a><code>simple_output</code>
</h4>
<p>Control the output structure, See next section.</p>
</div>
</div>
<div id="output" class="section level2">
<h2 class="hasAnchor">
<a href="#output" class="anchor"></a>3. Output</h2>
<p>By default (<code>simple_output = TRUE</code>), the output of <code>attack_model</code> is a <code>data.frame</code> with every row representing an instance (or ‘frame’) of the model at the input <code>frequency</code>. The data frame contains columns for frame, speed, time, time reversed, distance of the nose of the predator, <strong>α</strong>, and <strong>dα/dt</strong>.</p>
<p>If <code>simple_output = FALSE</code> the output is a <code>list</code> object given class <code>attack_model</code> containing the above data frame, plus inputs, subset regions (if <strong>⍺</strong> or <strong>d⍺/dt</strong> ranges are entered), and data detailing how <strong>⍺</strong> was calculated (interpolated profiles, locations of maximum apparent width at each frame, etc.). This option greatly increases the time the function takes to run. However, it is required if you intend to create a looming animation from the output in the <a href="https://nicholascarey.github.io/loomeR/"><code>loomeR</code></a> package.</p>
<p>The output is also plotted by default (<code>plot = TRUE</code>), and if <strong>⍺</strong> or <strong>d⍺/dt</strong> ranges are entered these are also plotted.</p>
</div>
<div id="identifying-predator-distance-and-time-at-particular-and-ddt" class="section level2">
<h2 class="hasAnchor">
<a href="#identifying-predator-distance-and-time-at-particular-and-ddt" class="anchor"></a>4. Identifying predator distance and time at particular <strong>⍺</strong> and <strong>d⍺/dt</strong>
</h2>
<p>The functions <a href="https://nicholascarey.github.io/attackR/reference/get_dist.html"><code>get_dist</code></a> and <a href="https://nicholascarey.github.io/attackR/reference/get_time.html"><code>get_time</code></a> will return the distance of the predator and time to reach the prey at the first instance of a particular <strong>⍺</strong> or <strong>d⍺/dt</strong> being exceeded.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">mod</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/attack_model.html">attack_model</a></span>(<span class="kw">speed</span> <span class="kw">=</span> <span class="fl">350</span>,                <span class="co"># speed in cm/s</span>
                    <span class="kw">model_length</span> <span class="kw">=</span> <span class="fl">500</span>,         <span class="co"># determines how far away predator starts attack from</span>
                    <span class="kw">frequency</span> <span class="kw">=</span> <span class="fl">60</span>,             <span class="co"># resolution/frame rate in Hz</span>
                    <span class="kw">body_length</span> <span class="kw">=</span> <span class="fl">146</span>,          <span class="co"># cm - from nose to tail</span>
                    <span class="kw">body_width_v</span> <span class="kw">=</span> <span class="fl">45</span>,          <span class="co"># cm - width at maximum width in vertical plane</span>
                    <span class="kw">profile_v</span> <span class="kw">=</span> <span class="no">sl_profile_v</span>)   <span class="co"># shape profile in vertical plane</span></pre></body></html></div>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="../reference/get_dist.html">get_dist</a></span>(<span class="no">mod</span>, <span class="kw">dadt</span> <span class="kw">=</span> <span class="fl">0.90</span>)
<span class="co">#&gt; attack_model input - distance is from nose</span>
<span class="co">#&gt; [1] 70</span></pre></body></html></div>
<p>At this speed, this predator is 70cm from the prey when the <strong>d⍺/dt</strong> value of 0.90 is first exceeded.</p>
</div>
<div id="creating-a-looming-animation-from-the-results" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-a-looming-animation-from-the-results" class="anchor"></a>5. Creating a looming animation from the results</h2>
<p>See the <a href="https://nicholascarey.github.io/loomeR/"><code>loomeR</code></a> package for creating a looming animation from the output of <code>attackR</code>. For this to work the output must be saved (i.e. assigned) as an object within <code>R</code>, and the option <code>simple_output = FALSE</code> must be used. This results in a <code>list</code> object of class <code>attack_model</code> which <code>loomeR</code> will recognise.</p>
<p>(<strong>NOTE</strong> 13-01-2020 - Not implemented just yet. Coming very soon!)</p>
</div>
<div id="additional-notes" class="section level2">
<h2 class="hasAnchor">
<a href="#additional-notes" class="anchor"></a>6. Additional Notes</h2>
<ul>
<li>All angle measurements are in <strong><em>radians</em></strong> and <strong>d⍺/dt</strong> is in <strong><em>rad/s</em></strong>.</li>
<li>No part of the predator body anterior to the maximum width can ever project a higher <strong>⍺</strong> than the maximum width, so shape profiles are only really important from the nose to the maximum width. Values more posterior than that can be placeholders and they will not affect the results. However it is important they have values to maintain the evenly-spaced resolution of the profiles.</li>
</ul>
</div>
</div>
<div id="more-advanced-example" class="section level1">
<h1 class="hasAnchor">
<a href="#more-advanced-example" class="anchor"></a>More advanced example</h1>
<p>See <a href="https://nicholascarey.github.io/attackR/articles/whales.html">here</a> for the much more complicated case of how this approach was applied to attacks by lunge-feeding whales.</p>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>Cade D.E., Carey N., Domenici P., Potvin J., &amp; Goldbogen J.A., 2020. Predator-informed looming stimulus experiments reveal how large filter feeding whales capture highly maneuverable forage fish. <em>Proceedings of the National Academy of Sciences</em>, 117 (1) 472-478. <a href="https://doi.org/10.1073/pnas.1911099116" class="uri">https://doi.org/10.1073/pnas.1911099116</a></p>
<p>Dill L.M., 1974. The escape response of the zebra danio (<em>Brachydanio rerio</em>) I. The stimulus for escape. <em>Animal Behaviour</em> 22, 711–722. <a href="https://doi.org/10.1016/S0003-3472(74)80022-9" class="uri">https://doi.org/10.1016/S0003-3472(74)80022-9</a></p>
<p>Domenici, P., Hale, M.E., 2019. Escape responses of fish: a review of the diversity in motor control, kinematics and behaviour. <em>Journal of Experimental Biology</em> 222, jeb166009. <a href="https://doi.org/10.1242/jeb.166009" class="uri">https://doi.org/10.1242/jeb.166009</a></p>
<p>English, A.Wm., 1976. Limb movements and locomotor function in the California sea lion (Zalophus californianus). Journal of Zoology 178, 341–364. <a href="https://doi.org/10.1111/j.1469-7998.1976.tb02274.x" class="uri">https://doi.org/10.1111/j.1469-7998.1976.tb02274.x</a></p>
<p>Feldkamp, S.D., 1987. Swimming in the California sea lion: morphometrics, drag and energetics. Journal of Experimental Biology 131, 117–135.</p>
<p>Hatsopoulos N., Gabbiani F., &amp; Laurent G., 1995. Elementary computation of object approach by a wide-field visual neuron. <em>Science</em> 270(5238):1000-1003.</p>
<p>Paglianti, A., Domenici, P., 2006. The effect of size on the timing of visually mediated escape behaviour in staghorn sculpin <em>Leptocottus armatus</em>. <em>Journal of Fish Biology</em> 68, 1177–1191. <a href="https://doi.org/10.1111/j.0022-1112.2006.00991.x" class="uri">https://doi.org/10.1111/j.0022-1112.2006.00991.x</a></p>
<p>Preuss T., Osei-Bonsu P.E., Weiss S.A., Wang C., &amp; Faber D.S., 2006. Neural representation of object approach in a decision-making motor circuit. <em>Journal of Neuroscience</em> 26(13):3454-3464.</p>
<p>Temizer I., Donovan J.C., Baier H., &amp; Semmelhack J.L., 2015. A visual pathway for looming-evoked escape in larval zebrafish. <em>Current Biology</em> 25(14):1823-1834.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Nicholas Carey, Dave Cade, Paolo Domenici.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
